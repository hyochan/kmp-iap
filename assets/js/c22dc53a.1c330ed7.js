"use strict";(self.webpackChunkkmp_iap_docs=self.webpackChunkkmp_iap_docs||[]).push([[3942],{5159:(e,n,r)=>{r.d(n,{A:()=>o});r(6540);var s=r(6025),t=r(7856),i=r(4848);function o({className:e="iapkit-banner",style:n}){const r=(0,s.A)("/img/iapkit-banner.gif");return(0,i.jsx)("div",{className:e,style:n,children:(0,i.jsx)("a",{href:t.V,target:"_blank",rel:"noopener noreferrer",onClick:async()=>{try{await fetch(t.I,{method:"POST",mode:"no-cors"})}catch(e){console.error("Failed to track banner click:",e)}},style:{display:"block",textAlign:"center",marginBottom:"20px",textDecoration:"none",cursor:"pointer"},children:(0,i.jsx)("img",{src:r,alt:"IAPKit - In-App Purchase Made Simple",style:{height:"auto",borderRadius:"8px",objectFit:"contain"}})})})}},7856:(e,n,r)=>{r.d(n,{I:()=>t,V:()=>s});const s="https://iapkit.com",t="https://www.hyo.dev/api/ad-banner/cmjf0l20n0002249hjrwmgob3"},8453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>a});var s=r(6540);const t={},i=s.createContext(t);function o(e){const n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),s.createElement(i.Provider,{value:n},e.children)}},9787:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>l,frontMatter:()=>o,metadata:()=>c,toc:()=>p});var s=r(4848),t=r(8453),i=r(5159);const o={title:"Android Setup",sidebar_label:"Android Setup",sidebar_position:3},a="Android Setup",c={id:"getting-started/android-setup",title:"Android Setup",description:"For complete Android setup instructions including Google Play Console configuration, app setup, and testing guidelines, please visit:",source:"@site/versioned_docs/version-1.0.0-rc/getting-started/android-setup.md",sourceDirName:"getting-started",slug:"/getting-started/android-setup",permalink:"/kmp-iap/docs/1.0.0-rc/getting-started/android-setup",draft:!1,unlisted:!1,editUrl:"https://github.com/hyochan/kmp-iap/tree/main/docs/versioned_docs/version-1.0.0-rc/getting-started/android-setup.md",tags:[],version:"1.0.0-rc",sidebarPosition:3,frontMatter:{title:"Android Setup",sidebar_label:"Android Setup",sidebar_position:3},sidebar:"docsSidebar",previous:{title:"iOS Setup",permalink:"/kmp-iap/docs/1.0.0-rc/getting-started/ios-setup"},next:{title:"Purchases",permalink:"/kmp-iap/docs/1.0.0-rc/guides/purchases"}},d={},p=[{value:"Code Implementation",id:"code-implementation",level:2},{value:"Basic Setup",id:"basic-setup",level:3},{value:"Android-specific Features",id:"android-specific-features",level:3},{value:"Error Handling",id:"error-handling",level:3},{value:"Next Steps",id:"next-steps",level:2}];function u(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"android-setup",children:"Android Setup"}),"\n",(0,s.jsx)(i.A,{}),"\n",(0,s.jsx)(n.p,{children:"For complete Android setup instructions including Google Play Console configuration, app setup, and testing guidelines, please visit:"}),"\n",(0,s.jsxs)(n.p,{children:["\ud83d\udc49 ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.a,{href:"https://openiap.dev/docs/android-setup",children:"Android Setup Guide - openiap.dev"})})]}),"\n",(0,s.jsx)(n.p,{children:"The guide covers:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Google Play Console configuration"}),"\n",(0,s.jsx)(n.li,{children:"App bundle setup and signing"}),"\n",(0,s.jsx)(n.li,{children:"Testing with internal testing tracks"}),"\n",(0,s.jsx)(n.li,{children:"Common troubleshooting steps"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"code-implementation",children:"Code Implementation"}),"\n",(0,s.jsx)(n.h3,{id:"basic-setup",children:"Basic Setup"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-kotlin",children:'import io.github.hyochan.kmpiap.kmpIapInstance\nimport io.github.hyochan.kmpiap.openiap.*\nimport kotlinx.coroutines.*\n\nclass IAPManager {\n    private val scope = CoroutineScope(Dispatchers.Main)\n\n    fun initialize() {\n        scope.launch {\n            try {\n                // Initialize connection\n                kmpIapInstance.initConnection()\n                println("Billing client connected")\n\n                // Set up purchase listeners\n                setupPurchaseListeners()\n\n                // Load products\n                loadProducts()\n            } catch (e: Exception) {\n                println("Failed to initialize: ${e.message}")\n            }\n        }\n    }\n    \n    private fun setupPurchaseListeners() {\n        scope.launch {\n            // Listen for purchase updates\n            kmpIAP.purchaseUpdatedListener.collect { purchase ->\n                handlePurchaseUpdate(purchase)\n            }\n        }\n        \n        scope.launch {\n            // Listen for purchase errors\n            kmpIAP.purchaseErrorListener.collect { error ->\n                handlePurchaseError(error)\n            }\n        }\n    }\n    \n    private suspend fun loadProducts() {\n        try {\n            val products = kmpIAP.fetchProducts {\n                skus = listOf("premium_upgrade", "remove_ads")\n                type = ProductQueryType.InApp\n            }\n            println("Found ${products.size} products")\n        } catch (e: Exception) {\n            println("Failed to load products: ${e.message}")\n        }\n    }\n    \n    private suspend fun handlePurchaseUpdate(purchase: Purchase) {\n        // Verify purchase with your backend\n        val isValid = verifyPurchaseWithBackend(purchase)\n        \n        if (isValid) {\n            // Grant entitlement\n            grantEntitlement(purchase.productId)\n            \n            // Finish transaction\n            kmpIapInstance.finishTransaction(\n                purchase.toPurchaseInput(),\n                isConsumable = isConsumableProduct(purchase.productId)\n            )\n        }\n    }\n    \n    private fun handlePurchaseError(error: PurchaseError) {\n        when (error.code) {\n            ErrorCode.UserCancelled -> {\n                // User cancelled, no action needed\n            }\n            ErrorCode.AlreadyOwned -> {\n                // Item already owned, restore it\n                restorePurchases()\n            }\n            else -> {\n                // Show error to user\n                showError(error.message)\n            }\n        }\n    }\n    \n    suspend fun purchaseProduct(productId: String) {\n        kmpIAP.requestPurchase {\n            ios {\n                sku = productId\n                quantity = 1\n            }\n            android {\n                skus = listOf(productId)\n            }\n        }\n    }\n    \n    suspend fun restorePurchases() {\n        val purchases = kmpIAP.getAvailablePurchases()\n        purchases.forEach { purchase ->\n            grantEntitlement(purchase.productId)\n        }\n    }\n    \n    private suspend fun verifyPurchaseWithBackend(purchase: Purchase): Boolean {\n        // TODO: Implement your backend verification\n        return true\n    }\n    \n    private fun grantEntitlement(productId: String) {\n        // Grant the appropriate entitlement based on productId\n        when (productId) {\n            "remove_ads" -> UserSettings.adsRemoved = true\n            "premium_upgrade" -> UserSettings.isPremium = true\n            // Handle other products\n        }\n    }\n    \n    private fun isConsumableProduct(productId: String): Boolean {\n        return when (productId) {\n            "coins_100", "coins_500" -> true\n            else -> false\n        }\n    }\n    \n    private fun showError(message: String) {\n        // Show error message to user\n    }\n    \n    fun cleanup() {\n        scope.cancel()\n        runBlocking {\n            kmpIapInstance.endConnection()\n        }\n    }\n}\n\n// Simple user settings example\nobject UserSettings {\n    var adsRemoved: Boolean = false\n    var isPremium: Boolean = false\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"android-specific-features",children:"Android-specific Features"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-kotlin",children:'// Use obfuscated account IDs for enhanced security\nkmpIAP.requestPurchase {\n    ios {\n        sku = "premium_upgrade"\n        quantity = 1\n    }\n    android {\n        skus = listOf("premium_upgrade")\n        obfuscatedAccountIdAndroid = "user_account_123"\n        obfuscatedProfileIdAndroid = "profile_456"\n    }\n}\n\n// Acknowledge a purchase (for non-consumables)\nkmpIAP.acknowledgePurchaseAndroid(purchase.purchaseToken)\n\n// Consume a purchase (for consumables)\nkmpIAP.consumePurchaseAndroid(purchase.purchaseToken)\n\n// Deep link to subscription management\nkmpIAP.deepLinkToSubscriptions(\n    DeepLinkOptions(skuAndroid = "subscription_id")\n)\n'})}),"\n",(0,s.jsx)(n.h3,{id:"error-handling",children:"Error Handling"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-kotlin",children:'scope.launch {\n    kmpIAP.purchaseErrorListener.collect { error ->\n        when (error.code) {\n            ErrorCode.ServiceUnavailable -> {\n                // Google Play services unavailable\n                showDialog("Please update Google Play services")\n            }\n            ErrorCode.BillingUnavailable -> {\n                // Billing API version not supported\n                showDialog("In-app purchases not supported on this device")\n            }\n            ErrorCode.ItemUnavailable -> {\n                // Product not found or not available for purchase\n                showDialog("This item is currently unavailable")\n            }\n            ErrorCode.DeveloperError -> {\n                // Invalid arguments provided to the API\n                println("Developer error: Check product configuration")\n            }\n            else -> {\n                showDialog("Purchase failed: ${error.message}")\n            }\n        }\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.a,{href:"/docs/getting-started/ios-setup",children:"iOS Setup"})})," - Configure for iOS platform"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.a,{href:"/docs/guides/purchases",children:"Basic Implementation"})})," - Start implementing purchases"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.a,{href:"/docs/guides/troubleshooting",children:"Troubleshooting"})})," - Common issues and solutions"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.p,{children:["For detailed platform configuration, product setup, and testing instructions, visit the ",(0,s.jsx)(n.a,{href:"https://openiap.dev/docs/android-setup",children:"Android Setup Guide at openiap.dev"}),"."]})]})}function l(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}}}]);