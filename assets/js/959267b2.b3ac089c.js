"use strict";(self.webpackChunkkmp_iap_docs=self.webpackChunkkmp_iap_docs||[]).push([[5078],{4418:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>p,frontMatter:()=>t,metadata:()=>d,toc:()=>c});var s=i(4848),r=i(8453);const t={slug:"release-1.3.2",title:"1.3.2 - Android Product Status Codes & Type Updates",authors:["hyochan"],tags:["release","openiap","kmp","ios","android"],description:"KMP-IAP 1.3.2 syncs with OpenIAP gql v1.3.14 - adding Android product status codes, new Kotlin types for iOS subscription options, and displayPrice fix for free trials.",date:new Date("2026-01-19T00:00:00.000Z")},o="KMP-IAP 1.3.2",d={permalink:"/kmp-iap/blog/release-1.3.2",editUrl:"https://github.com/hyochan/kmp-iap/tree/main/docs/blog/2026-01-19-release-1.3.2.md",source:"@site/blog/2026-01-19-release-1.3.2.md",title:"1.3.2 - Android Product Status Codes & Type Updates",description:"KMP-IAP 1.3.2 syncs with OpenIAP gql v1.3.14 - adding Android product status codes, new Kotlin types for iOS subscription options, and displayPrice fix for free trials.",date:"2026-01-19T00:00:00.000Z",formattedDate:"January 19, 2026",tags:[{label:"release",permalink:"/kmp-iap/blog/tags/release"},{label:"openiap",permalink:"/kmp-iap/blog/tags/openiap"},{label:"kmp",permalink:"/kmp-iap/blog/tags/kmp"},{label:"ios",permalink:"/kmp-iap/blog/tags/ios"},{label:"android",permalink:"/kmp-iap/blog/tags/android"}],readingTime:2.56,hasTruncateMarker:!0,authors:[{name:"Hyo",title:"Maintainer of kmp-iap",url:"https://github.com/hyochan",imageURL:"https://github.com/hyochan.png",key:"hyochan"}],frontMatter:{slug:"release-1.3.2",title:"1.3.2 - Android Product Status Codes & Type Updates",authors:["hyochan"],tags:["release","openiap","kmp","ios","android"],description:"KMP-IAP 1.3.2 syncs with OpenIAP gql v1.3.14 - adding Android product status codes, new Kotlin types for iOS subscription options, and displayPrice fix for free trials.",date:"2026-01-19T00:00:00.000Z"},unlisted:!1,prevItem:{title:"1.3.4 - One-Time Purchase Discounts & Simplified Field Names",permalink:"/kmp-iap/blog/release-1.3.4"},nextItem:{title:"1.3.0 - PurchaseState Cleanup & API Consolidation",permalink:"/kmp-iap/blog/release-1.3.0"}},l={authorsImageUrls:[void 0]},c=[{value:"New Features",id:"new-features",level:2},{value:"Android Product Status Codes (Billing 8.0+)",id:"android-product-status-codes-billing-80",level:3},{value:"New Types &amp; DSL Updates",id:"new-types--dsl-updates",level:2},{value:"iOS Subscription Options (Types Only)",id:"ios-subscription-options-types-only",level:3},{value:"Android Suspended Subscriptions Option (Billing 8.1+)",id:"android-suspended-subscriptions-option-billing-81",level:3},{value:"Breaking Changes",id:"breaking-changes",level:2},{value:"iOS Subscription-Only Props Cleanup",id:"ios-subscription-only-props-cleanup",level:3},{value:"Bug Fixes",id:"bug-fixes",level:2},{value:"Android displayPrice Fix for Free Trials",id:"android-displayprice-fix-for-free-trials",level:3},{value:"New Types",id:"new-types",level:2},{value:"OpenIAP Versions",id:"openiap-versions",level:2},{value:"Installation",id:"installation",level:2},{value:"References",id:"references",level:2}];function a(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:["This release syncs with ",(0,s.jsx)(n.a,{href:"https://www.openiap.dev/docs/updates/notes#gql-1-3-14-google-1-3-25-apple-1-3-13",children:"OpenIAP gql v1.3.14 / google v1.3.25 / apple v1.3.13"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"new-features",children:"New Features"}),"\n",(0,s.jsx)(n.h3,{id:"android-product-status-codes-billing-80",children:"Android Product Status Codes (Billing 8.0+)"}),"\n",(0,s.jsx)(n.p,{children:"Products now include status codes explaining fetch results:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-kotlin",children:'val products = kmpIapInstance.fetchProducts {\n    skus = listOf("premium_monthly")\n    type = ProductQueryType.Subs\n}\n\nproducts.forEach { product ->\n    when ((product as? ProductAndroid)?.productStatusAndroid) {\n        ProductStatusAndroid.Ok -> println("Product fetched successfully")\n        ProductStatusAndroid.NotFound -> println("SKU doesn\'t exist")\n        ProductStatusAndroid.NoOffersAvailable -> println("User not eligible")\n        ProductStatusAndroid.Unknown -> println("Unknown status")\n        null -> {} // iOS or no status\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"new-types--dsl-updates",children:"New Types & DSL Updates"}),"\n",(0,s.jsx)(n.h3,{id:"ios-subscription-options-types-only",children:"iOS Subscription Options (Types Only)"}),"\n",(0,s.jsxs)(n.p,{children:["The following new iOS subscription options are now available in Kotlin types and DSL builders for ",(0,s.jsx)(n.strong,{children:"forward compatibility"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"introductoryOfferEligibility"})," - Override introductory offer eligibility (iOS 15+, WWDC 2025)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"promotionalOfferJWS"})," - JWS promotional offer (iOS 15+, WWDC 2025)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"winBackOffer"})," - Win-back offer for iOS 18+"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-kotlin",children:'// DSL syntax available\nkmpIapInstance.requestPurchase {\n    type = ProductType.Subs\n    ios {\n        sku = "premium_monthly"\n        winBackOffer = WinBackOfferInputIOS(offerId = "winback_50_off")\n        promotionalOfferJWS = PromotionalOfferJWSInputIOS(offerId = "promo", jws = "...")\n        introductoryOfferEligibility = true\n    }\n}\n'})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Note:"})," These options require OpenIAP's ObjC bridge update to function. Currently, kmp-iap's cinterop calls the ObjC bridge ",(0,s.jsx)(n.code,{children:"requestSubscriptionWithSku(sku, offer)"})," which doesn't accept these new parameters. The legacy ",(0,s.jsx)(n.code,{children:"withOffer"})," (DiscountOfferInputIOS) continues to work."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"android-suspended-subscriptions-option-billing-81",children:"Android Suspended Subscriptions Option (Billing 8.1+)"}),"\n",(0,s.jsxs)(n.p,{children:["New ",(0,s.jsx)(n.code,{children:"includeSuspendedAndroid"})," option added to ",(0,s.jsx)(n.code,{children:"PurchaseOptions"})," for fetching suspended subscriptions:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-kotlin",children:'// Fetch available purchases including suspended subscriptions\nval purchases = kmpIapInstance.getAvailablePurchases(\n    PurchaseOptions(includeSuspendedAndroid = true)\n)\n\npurchases.forEach { purchase ->\n    println("Product: ${purchase.productId}, State: ${purchase.purchaseState}")\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"This option uses reflection for backward compatibility with older Billing Library versions. When the underlying library doesn't support this feature, it gracefully degrades to the default behavior."}),"\n",(0,s.jsx)(n.h2,{id:"breaking-changes",children:"Breaking Changes"}),"\n",(0,s.jsx)(n.h3,{id:"ios-subscription-only-props-cleanup",children:"iOS Subscription-Only Props Cleanup"}),"\n",(0,s.jsxs)(n.p,{children:["Removed subscription-specific fields from ",(0,s.jsx)(n.code,{children:"RequestPurchaseIosProps"}),". These fields now only exist in ",(0,s.jsx)(n.code,{children:"RequestSubscriptionIosProps"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"introductoryOfferEligibility"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"promotionalOfferJWS"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"winBackOffer"})}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Migration:"})," If using these fields for purchases, switch to ",(0,s.jsx)(n.code,{children:"requestSubscription()"})," API."]}),"\n",(0,s.jsx)(n.h2,{id:"bug-fixes",children:"Bug Fixes"}),"\n",(0,s.jsx)(n.h3,{id:"android-displayprice-fix-for-free-trials",children:"Android displayPrice Fix for Free Trials"}),"\n",(0,s.jsxs)(n.p,{children:["Fixed an issue where ",(0,s.jsx)(n.code,{children:"displayPrice"}),' returned "Free" or "$0.00" for subscription products with free trials. Now returns the actual base/recurring price.']}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-kotlin",children:'// Before (bug)\nproduct.displayPrice  // "Free" or "$0.00"\nproduct.price         // 0.0\n\n// After (fixed)\nproduct.displayPrice  // "$9.99" (base recurring price)\nproduct.price         // 9.99\n\n// Free trial info is still available in subscriptionOffers\nproduct.subscriptionOffers[0].displayPrice   // "$0.00"\nproduct.subscriptionOffers[0].paymentMode    // FreeTrial\n'})}),"\n",(0,s.jsx)(n.h2,{id:"new-types",children:"New Types"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Platform"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"WinBackOfferInputIOS"})}),(0,s.jsx)(n.td,{children:"iOS"}),(0,s.jsx)(n.td,{children:"Win-back offer input for iOS 18+"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"PromotionalOfferJWSInputIOS"})}),(0,s.jsx)(n.td,{children:"iOS"}),(0,s.jsx)(n.td,{children:"JWS promotional offer for iOS 15+"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"ProductStatusAndroid"})}),(0,s.jsx)(n.td,{children:"Android"}),(0,s.jsx)(n.td,{children:"Product fetch status codes"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"SubResponseCodeAndroid"})}),(0,s.jsx)(n.td,{children:"Android"}),(0,s.jsx)(n.td,{children:"Sub-response codes for errors"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"BillingResultAndroid"})}),(0,s.jsx)(n.td,{children:"Android"}),(0,s.jsx)(n.td,{children:"Extended billing result with sub-response"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"openiap-versions",children:"OpenIAP Versions"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Package"}),(0,s.jsx)(n.th,{children:"Version"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"openiap-gql"}),(0,s.jsx)(n.td,{children:"1.3.14"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"openiap-google"}),(0,s.jsx)(n.td,{children:"1.3.25"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"openiap-apple"}),(0,s.jsx)(n.td,{children:"1.3.13"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-kotlin",children:'implementation("io.github.hyochan:kmp-iap:1.3.2")\n'})}),"\n",(0,s.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.openiap.dev/docs/updates/notes#gql-1-3-14-google-1-3-25-apple-1-3-13",children:"OpenIAP gql v1.3.14 / google v1.3.25 / apple v1.3.13 Release Notes"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.openiap.dev/docs/updates/notes#gql-1-3-13-google-1-3-24-apple-1-3-11",children:"OpenIAP gql v1.3.13 Release Notes"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/blog/release-1.3.0",children:"1.3.0 Release Notes"})," - Previous release"]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>d});var s=i(6540);const r={},t=s.createContext(r);function o(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);