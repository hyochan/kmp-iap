"use strict";(self.webpackChunkkmp_iap_docs=self.webpackChunkkmp_iap_docs||[]).push([[1300],{5159:(n,e,i)=>{i.d(e,{A:()=>o});i(6540);var s=i(6025),l=i(7856),t=i(4848);function o({className:n="iapkit-banner",style:e}){const i=(0,s.A)("/img/iapkit-banner.gif");return(0,t.jsx)("div",{className:n,style:e,children:(0,t.jsx)("a",{href:l.V,target:"_blank",rel:"noopener noreferrer",onClick:async()=>{try{await fetch(l.I,{method:"POST",mode:"no-cors"})}catch(n){console.error("Failed to track banner click:",n)}},style:{display:"block",textAlign:"center",marginBottom:"20px",textDecoration:"none",cursor:"pointer"},children:(0,t.jsx)("img",{src:i,alt:"IAPKit - In-App Purchase Made Simple",style:{height:"auto",borderRadius:"8px",objectFit:"contain"}})})})}},6153:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>d,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>a,toc:()=>c});var s=i(4848),l=i(8453),t=i(5159);const o={title:"Installation & Setup",sidebar_label:"Installation",sidebar_position:1},r="Installation & Setup",a={id:"getting-started/installation",title:"Installation & Setup",description:"Learn how to install and configure kmp-iap in your Kotlin Multiplatform project.",source:"@site/versioned_docs/version-1.0.0-beta/getting-started/installation.md",sourceDirName:"getting-started",slug:"/getting-started/installation",permalink:"/kmp-iap/docs/1.0.0-beta/getting-started/installation",draft:!1,unlisted:!1,editUrl:"https://github.com/hyochan/kmp-iap/tree/main/docs/versioned_docs/version-1.0.0-beta/getting-started/installation.md",tags:[],version:"1.0.0-beta",sidebarPosition:1,frontMatter:{title:"Installation & Setup",sidebar_label:"Installation",sidebar_position:1},sidebar:"docsSidebar",previous:{title:"Introduction",permalink:"/kmp-iap/docs/1.0.0-beta/intro"},next:{title:"iOS Setup",permalink:"/kmp-iap/docs/1.0.0-beta/getting-started/ios-setup"}},d={},c=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Package Installation",id:"package-installation",level:2},{value:"In your shared module&#39;s <code>build.gradle.kts</code>",id:"in-your-shared-modules-buildgradlekts",level:3},{value:"Platform Configuration",id:"platform-configuration",level:2},{value:"iOS Configuration",id:"ios-configuration",level:3},{value:"Link the OpenIAP native module",id:"link-the-openiap-native-module",level:4},{value:"Enable In-App Purchase Capability",id:"enable-in-app-purchase-capability",level:4},{value:"Configure Info.plist (iOS 14+)",id:"configure-infoplist-ios-14",level:4},{value:"StoreKit Configuration (Optional)",id:"storekit-configuration-optional",level:4},{value:"Android Configuration",id:"android-configuration",level:3},{value:"Update build.gradle",id:"update-buildgradle",level:4},{value:"Add Billing Client dependency",id:"add-billing-client-dependency",level:4},{value:"Permissions",id:"permissions",level:4},{value:"Configuration",id:"configuration",level:2},{value:"App Store Connect (iOS)",id:"app-store-connect-ios",level:3},{value:"Google Play Console (Android)",id:"google-play-console-android",level:3},{value:"Verification",id:"verification",level:2},{value:"Initialize the Plugin",id:"initialize-the-plugin",level:3},{value:"Test Connection",id:"test-connection",level:3},{value:"Next Steps",id:"next-steps",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"iOS Common Issues",id:"ios-common-issues",level:3},{value:"Permission Denied",id:"permission-denied",level:4},{value:"Products Not Loading",id:"products-not-loading",level:4},{value:"Android Common Issues",id:"android-common-issues",level:3},{value:"Billing Unavailable",id:"billing-unavailable",level:4},{value:"Products Not Found",id:"products-not-found",level:4}];function p(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.h1,{id:"installation--setup",children:"Installation & Setup"}),"\n",(0,s.jsx)(t.A,{}),"\n",(0,s.jsx)(e.p,{children:"Learn how to install and configure kmp-iap in your Kotlin Multiplatform project."}),"\n",(0,s.jsx)(e.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,s.jsx)(e.p,{children:"Before installing kmp-iap, ensure you have:"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Kotlin 2.1.10 or higher"}),"\n",(0,s.jsx)(e.li,{children:"Gradle 8.0 or higher"}),"\n",(0,s.jsx)(e.li,{children:"Active Apple Developer account (for iOS)"}),"\n",(0,s.jsx)(e.li,{children:"Active Google Play Developer account (for Android)"}),"\n",(0,s.jsx)(e.li,{children:"Physical device for testing (simulators/emulators have limited support)"}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"package-installation",children:"Package Installation"}),"\n",(0,s.jsx)(e.p,{children:"Add kmp-iap to your project's dependencies:"}),"\n",(0,s.jsxs)(e.h3,{id:"in-your-shared-modules-buildgradlekts",children:["In your shared module's ",(0,s.jsx)(e.code,{children:"build.gradle.kts"})]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-kotlin",children:'val commonMain by getting {\n    dependencies {\n        implementation("io.github.hyochan:kmp-iap:1.0.0-beta.14")\n    }\n}\n'})}),"\n",(0,s.jsx)(e.p,{children:"Or if using version catalogs:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-toml",children:'# gradle/libs.versions.toml\n[versions]\nkmp-iap = "1.0.0-beta.14"\n\n[libraries]\nkmp-iap = { module = "io.github.hyochan:kmp-iap", version.ref = "kmp-iap" }\n'})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-kotlin",children:"// build.gradle.kts\ndependencies {\n    implementation(libs.kmp.iap)\n}\n"})}),"\n",(0,s.jsx)(e.h2,{id:"platform-configuration",children:"Platform Configuration"}),"\n",(0,s.jsx)(e.h3,{id:"ios-configuration",children:"iOS Configuration"}),"\n",(0,s.jsx)(e.h4,{id:"link-the-openiap-native-module",children:"Link the OpenIAP native module"}),"\n",(0,s.jsxs)(e.p,{children:["The iOS side must link against ",(0,s.jsx)(e.a,{href:"https://github.com/hyodotdev/openiap",children:"OpenIAP"}),". Add the pod to your shared module so CocoaPods installs it together with your Kotlin framework:"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-kotlin",children:'// shared/build.gradle.kts\nval openIapVersion = "1.2.39" // Match the version bundled with your kmp-iap release\n\nkotlin {\n    cocoapods {\n        pod("openiap") {\n            version = openIapVersion\n            source = git("https://github.com/hyodotdev/openiap.git") {\n                tag = "apple-v$openIapVersion"\n            }\n            moduleName = "OpenIAP"\n        }\n    }\n}\n'})}),"\n",(0,s.jsx)(e.p,{children:"If you edit the Podfile manually, make sure it includes the same dependency:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-ruby",children:"pod 'OpenIAP', '1.2.39'\n"})}),"\n",(0,s.jsxs)(e.p,{children:["Missing this step leads to ",(0,s.jsx)(e.code,{children:"Undefined symbol '_OBJC_CLASS_$__TtC7OpenIAP13OpenIapModule'"})," errors at link time."]}),"\n",(0,s.jsx)(e.h4,{id:"enable-in-app-purchase-capability",children:"Enable In-App Purchase Capability"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsx)(e.li,{children:"Open your project in Xcode"}),"\n",(0,s.jsx)(e.li,{children:"Select your project in the navigator"}),"\n",(0,s.jsx)(e.li,{children:"Select your target"}),"\n",(0,s.jsxs)(e.li,{children:["Go to ",(0,s.jsx)(e.strong,{children:"Signing & Capabilities"})," tab"]}),"\n",(0,s.jsxs)(e.li,{children:["Click ",(0,s.jsx)(e.strong,{children:"+ Capability"})," and add ",(0,s.jsx)(e.strong,{children:"In-App Purchase"})]}),"\n"]}),"\n",(0,s.jsx)(e.h4,{id:"configure-infoplist-ios-14",children:"Configure Info.plist (iOS 14+)"}),"\n",(0,s.jsxs)(e.p,{children:["Add the following to your ",(0,s.jsx)(e.code,{children:"iosApp/Info.plist"}),":"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-xml",children:"<key>LSApplicationQueriesSchemes</key>\n<array>\n    <string>itms-apps</string>\n</array>\n"})}),"\n",(0,s.jsx)(e.h4,{id:"storekit-configuration-optional",children:"StoreKit Configuration (Optional)"}),"\n",(0,s.jsxs)(e.p,{children:["For testing with StoreKit 2, create a ",(0,s.jsx)(e.code,{children:".storekit"})," configuration file:"]}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:["In Xcode, go to ",(0,s.jsx)(e.strong,{children:"File"})," \u2192 ",(0,s.jsx)(e.strong,{children:"New"})," \u2192 ",(0,s.jsx)(e.strong,{children:"File"})]}),"\n",(0,s.jsxs)(e.li,{children:["Choose ",(0,s.jsx)(e.strong,{children:"StoreKit Configuration File"})]}),"\n",(0,s.jsx)(e.li,{children:"Add your products for testing"}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"android-configuration",children:"Android Configuration"}),"\n",(0,s.jsx)(e.h4,{id:"update-buildgradle",children:"Update build.gradle"}),"\n",(0,s.jsxs)(e.p,{children:["Ensure your ",(0,s.jsx)(e.code,{children:"androidApp/build.gradle.kts"})," has the minimum SDK version:"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-kotlin",children:"android {\n    compileSdk = 34\n\n    defaultConfig {\n        minSdk = 24  // Required minimum\n        targetSdk = 34\n    }\n}\n"})}),"\n",(0,s.jsx)(e.h4,{id:"add-billing-client-dependency",children:"Add Billing Client dependency"}),"\n",(0,s.jsx)(e.p,{children:"The library includes the billing client, but ensure ProGuard rules are configured if using ProGuard:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-proguard",children:"# In-App Purchase\n-keep class com.android.billingclient.** { *; }\n-keep class io.github.hyochan.kmpiap.** { *; }\n-keepattributes *Annotation*\n"})}),"\n",(0,s.jsx)(e.h4,{id:"permissions",children:"Permissions"}),"\n",(0,s.jsx)(e.p,{children:"The library automatically adds the required billing permission to your manifest."}),"\n",(0,s.jsx)(e.h2,{id:"configuration",children:"Configuration"}),"\n",(0,s.jsx)(e.h3,{id:"app-store-connect-ios",children:"App Store Connect (iOS)"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:["Sign in to ",(0,s.jsx)(e.a,{href:"https://appstoreconnect.apple.com",children:"App Store Connect"})]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Select your app"}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:["Navigate to ",(0,s.jsx)(e.strong,{children:"Monetization"})," \u2192 ",(0,s.jsx)(e.strong,{children:"In-App Purchases"})]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Create your products:"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Consumable"}),": Can be purchased multiple times"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Non-Consumable"}),": One-time purchase"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Auto-Renewable Subscription"}),": Recurring payments"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Non-Renewing Subscription"}),": Fixed duration"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Fill in required fields:"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Reference Name (internal use)"}),"\n",(0,s.jsx)(e.li,{children:"Product ID (used in code)"}),"\n",(0,s.jsx)(e.li,{children:"Pricing"}),"\n",(0,s.jsx)(e.li,{children:"Localizations"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Submit for review with your app"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"google-play-console-android",children:"Google Play Console (Android)"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:["Sign in to ",(0,s.jsx)(e.a,{href:"https://play.google.com/console",children:"Google Play Console"})]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Select your app"}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:["Navigate to ",(0,s.jsx)(e.strong,{children:"Monetization"})," \u2192 ",(0,s.jsx)(e.strong,{children:"In-app products"})]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Create products:"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"One-time products"}),": Consumable or non-consumable"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Subscriptions"}),": Recurring payments"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Configure product details:"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Product ID (used in code)"}),"\n",(0,s.jsx)(e.li,{children:"Name and description"}),"\n",(0,s.jsx)(e.li,{children:"Price"}),"\n",(0,s.jsx)(e.li,{children:"Status (Active)"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Save and activate products"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"verification",children:"Verification"}),"\n",(0,s.jsx)(e.h3,{id:"initialize-the-plugin",children:"Initialize the Plugin"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-kotlin",children:'import io.github.hyochan.kmpiap.*\nimport io.github.hyochan.kmpiap.types.*\nimport kotlinx.coroutines.*\n\nclass IAPManager {\n    private val kmpIAP = KmpIAP()\n    private val scope = CoroutineScope(Dispatchers.Main)\n\n    fun initialize() {\n        scope.launch {\n            try {\n                kmpIAP.initConnection()\n                println("IAP connection initialized successfully")\n            } catch (e: PurchaseError) {\n                println("Failed to initialize IAP connection: $e")\n            }\n        }\n    }\n\n    fun dispose() {\n        scope.launch {\n            kmpIAP.endConnection()\n        }\n        scope.cancel()\n    }\n}\n'})}),"\n",(0,s.jsx)(e.h3,{id:"test-connection",children:"Test Connection"}),"\n",(0,s.jsx)(e.p,{children:"Test your setup with this verification code:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-kotlin",children:'suspend fun testConnection() {\n    import io.github.hyochan.kmpiap.kmpIapInstance\n\n    try {\n        // Initialize connection\n        val connected = kmpIapInstance.initConnection()\n        println("Connection status: $connected")\n\n        if (!connected) {\n            println("Failed to connect to store")\n            return\n        }\n\n        // Connection successful, test product fetching\n        val products = kmpIAP.requestProducts(\n            ProductRequest(\n                skus = listOf("test_product_id"),\n                type = ProductType.INAPP\n            )\n        )\n        println("Found ${products.size} products")\n\n    } catch (e: PurchaseError) {\n        println("Connection test failed: $e")\n    } finally {\n        kmpIAP.endConnection()\n    }\n}\n'})}),"\n",(0,s.jsx)(e.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,s.jsx)(e.p,{children:"Now that you have kmp-iap installed and configured:"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.a,{href:"/docs/getting-started/ios-setup",children:(0,s.jsx)(e.strong,{children:"iOS Setup Guide"})})," - iOS specific configuration"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.a,{href:"/docs/getting-started/android-setup",children:(0,s.jsx)(e.strong,{children:"Android Setup Guide"})})," - Android specific configuration"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.a,{href:"/docs/guides/purchases",children:(0,s.jsx)(e.strong,{children:"Basic Implementation"})})," - Learn the fundamentals"]}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,s.jsx)(e.h3,{id:"ios-common-issues",children:"iOS Common Issues"}),"\n",(0,s.jsx)(e.h4,{id:"permission-denied",children:"Permission Denied"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Ensure In-App Purchase capability is enabled"}),"\n",(0,s.jsx)(e.li,{children:"Verify your Apple Developer account has active agreements"}),"\n",(0,s.jsx)(e.li,{children:"Check that products are configured in App Store Connect"}),"\n"]}),"\n",(0,s.jsx)(e.h4,{id:"products-not-loading",children:"Products Not Loading"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Products must be submitted for review (at least once)"}),"\n",(0,s.jsx)(e.li,{children:"Wait 24 hours after creating products"}),"\n",(0,s.jsx)(e.li,{children:"Verify product IDs match exactly"}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"android-common-issues",children:"Android Common Issues"}),"\n",(0,s.jsx)(e.h4,{id:"billing-unavailable",children:"Billing Unavailable"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Test on a real device (not emulator)"}),"\n",(0,s.jsx)(e.li,{children:"Ensure Google Play is installed and up-to-date"}),"\n",(0,s.jsx)(e.li,{children:"Verify app is signed with the same key as uploaded to Play Console"}),"\n"]}),"\n",(0,s.jsx)(e.h4,{id:"products-not-found",children:"Products Not Found"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Products must be active in Play Console"}),"\n",(0,s.jsx)(e.li,{children:"App must be published (at least to internal testing)"}),"\n",(0,s.jsx)(e.li,{children:"Wait 2-3 hours after creating products"}),"\n"]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsxs)(e.p,{children:["Need help? Check our ",(0,s.jsx)(e.a,{href:"/docs/guides/troubleshooting",children:"troubleshooting guide"})," or ",(0,s.jsx)(e.a,{href:"https://github.com/hyochan/kmp-iap/issues",children:"open an issue"})," on GitHub."]})]})}function h(n={}){const{wrapper:e}={...(0,l.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(p,{...n})}):p(n)}},7856:(n,e,i)=>{i.d(e,{I:()=>l,V:()=>s});const s="https://iapkit.com",l="https://www.hyo.dev/api/ad-banner/cmjf0l20n0002249hjrwmgob3"},8453:(n,e,i)=>{i.d(e,{R:()=>o,x:()=>r});var s=i(6540);const l={},t=s.createContext(l);function o(n){const e=s.useContext(t);return s.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function r(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(l):n.components||l:o(n.components),s.createElement(t.Provider,{value:e},n.children)}}}]);