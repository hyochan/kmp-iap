"use strict";(self.webpackChunkkmp_iap_docs=self.webpackChunkkmp_iap_docs||[]).push([[1820],{4500:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>s,default:()=>h,frontMatter:()=>r,metadata:()=>t,toc:()=>d});var l=i(4848),a=i(8453);const r={slug:"release-1.2.2",title:"1.2.2 - External Payments Support (Japan)",authors:["hyochan"],tags:["release","patch"],description:"KMP-IAP 1.2.2 adds Google Play Billing Library 8.3.0 External Payments support for Japan.",date:new Date("2025-12-28T00:00:00.000Z")},s="KMP-IAP 1.2.2",t={permalink:"/kmp-iap/blog/release-1.2.2",editUrl:"https://github.com/hyochan/kmp-iap/tree/main/docs/blog/2025-12-28-release-1.2.2.md",source:"@site/blog/2025-12-28-release-1.2.2.md",title:"1.2.2 - External Payments Support (Japan)",description:"KMP-IAP 1.2.2 adds Google Play Billing Library 8.3.0 External Payments support for Japan.",date:"2025-12-28T00:00:00.000Z",formattedDate:"December 28, 2025",tags:[{label:"release",permalink:"/kmp-iap/blog/tags/release"},{label:"patch",permalink:"/kmp-iap/blog/tags/patch"}],readingTime:2.055,hasTruncateMarker:!0,authors:[{name:"Hyo",title:"Maintainer of kmp-iap",url:"https://github.com/hyochan",imageURL:"https://github.com/hyochan.png",key:"hyochan"}],frontMatter:{slug:"release-1.2.2",title:"1.2.2 - External Payments Support (Japan)",authors:["hyochan"],tags:["release","patch"],description:"KMP-IAP 1.2.2 adds Google Play Billing Library 8.3.0 External Payments support for Japan.",date:"2025-12-28T00:00:00.000Z"},unlisted:!1,prevItem:{title:"1.3.0 - PurchaseState Cleanup & API Consolidation",permalink:"/kmp-iap/blog/release-1.3.0"},nextItem:{title:"1.2.1 - OpenIAP Updates & DSL Enhancements",permalink:"/kmp-iap/blog/release-1.2.1"}},o={authorsImageUrls:[void 0]},d=[{value:"What&#39;s New",id:"whats-new",level:2},{value:"External Payments Support (Android 8.3.0+)",id:"external-payments-support-android-830",level:3},{value:"New APIs",id:"new-apis",level:4},{value:"New Types",id:"new-types",level:4},{value:"Usage Example",id:"usage-example",level:4},{value:"Key Differences from User Choice Billing",id:"key-differences-from-user-choice-billing",level:3},{value:"OpenIAP Dependency Updates",id:"openiap-dependency-updates",level:3},{value:"Installation",id:"installation",level:2},{value:"Gradle (Kotlin DSL)",id:"gradle-kotlin-dsl",level:3},{value:"Version Catalog (libs.versions.toml)",id:"version-catalog-libsversionstoml",level:3},{value:"CocoaPods",id:"cocoapods",level:3},{value:"Documentation",id:"documentation",level:2},{value:"References",id:"references",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(n.p,{children:["KMP-IAP 1.2.2 is a ",(0,l.jsx)(n.strong,{children:"patch release"})," that adds support for Google Play Billing Library 8.3.0's External Payments API, enabling side-by-side choice billing for users in Japan."]}),"\n",(0,l.jsx)(n.h2,{id:"whats-new",children:"What's New"}),"\n",(0,l.jsx)(n.h3,{id:"external-payments-support-android-830",children:"External Payments Support (Android 8.3.0+)"}),"\n",(0,l.jsx)(n.p,{children:"Added support for Google Play's External Payments billing program, which presents users with a side-by-side choice between Google Play Billing and the developer's external payment option directly in the purchase flow."}),"\n",(0,l.jsx)(n.admonition,{title:"Japan Only",type:"info",children:(0,l.jsx)(n.p,{children:"The External Payments program is currently only available for users in Japan."})}),"\n",(0,l.jsx)(n.h4,{id:"new-apis",children:"New APIs"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"InitConnectionConfig.enableBillingProgramAndroid"})," - Enable a billing program during connection initialization"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"developerProvidedBillingListener: Flow<DeveloperProvidedBillingDetailsAndroid>"})," - Listen for developer billing selection"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"BillingProgramAndroid.ExternalPayments"})," - New billing program enum value"]}),"\n"]}),"\n",(0,l.jsx)(n.h4,{id:"new-types",children:"New Types"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"DeveloperBillingOptionParamsAndroid"})," - Configure external payment in purchase flow"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"DeveloperBillingLaunchModeAndroid"})," - How to launch the external payment link"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"DeveloperProvidedBillingDetailsAndroid"})," - Contains ",(0,l.jsx)(n.code,{children:"externalTransactionToken"})," when user selects developer billing"]}),"\n"]}),"\n",(0,l.jsx)(n.h4,{id:"usage-example",children:"Usage Example"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-kotlin",children:'import io.github.hyochan.kmpiap.kmpIapInstance\nimport io.github.hyochan.kmpiap.openiap.*\n\n// Enable External Payments during connection initialization\nval config = InitConnectionConfig(\n    enableBillingProgramAndroid = BillingProgramAndroid.ExternalPayments\n)\nkmpIapInstance.initConnection(config)\n\n// Listen for developer billing selection\nscope.launch {\n    kmpIapInstance.developerProvidedBillingListener.collect { details ->\n        println("External Transaction Token: ${details.externalTransactionToken}")\n        // Report token to Google within 24 hours\n    }\n}\n\n// Request purchase with External Payments option\nkmpIapInstance.requestPurchase {\n    android {\n        skus = listOf("premium_product")\n        developerBillingOption = DeveloperBillingOptionParamsAndroid(\n            billingProgram = BillingProgramAndroid.ExternalPayments,\n            launchMode = DeveloperBillingLaunchModeAndroid.LaunchInExternalBrowserOrApp,\n            linkUri = "https://your-site.com/checkout"\n        )\n    }\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"key-differences-from-user-choice-billing",children:"Key Differences from User Choice Billing"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Feature"}),(0,l.jsx)(n.th,{children:"User Choice Billing"}),(0,l.jsx)(n.th,{children:"External Payments"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Billing Library"}),(0,l.jsx)(n.td,{children:"7.0+"}),(0,l.jsx)(n.td,{children:"8.3.0+"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Availability"}),(0,l.jsx)(n.td,{children:"Eligible regions"}),(0,l.jsx)(n.td,{children:"Japan only"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"UI"}),(0,l.jsx)(n.td,{children:"Separate dialog"}),(0,l.jsx)(n.td,{children:"Side-by-side in purchase dialog"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Token Source"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"userChoiceBillingListener"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"developerProvidedBillingListener"})})]})]})]}),"\n",(0,l.jsx)(n.h3,{id:"openiap-dependency-updates",children:"OpenIAP Dependency Updates"}),"\n",(0,l.jsx)(n.p,{children:"Updated to the latest OpenIAP versions:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"openiap-apple"}),": 1.3.8 (was 1.3.7)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"openiap-google"}),": 1.3.19 (was 1.3.15)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"openiap-gql"}),": 1.3.10 (was 1.3.8)"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,l.jsx)(n.h3,{id:"gradle-kotlin-dsl",children:"Gradle (Kotlin DSL)"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-kotlin",children:'// shared/build.gradle.kts\nkotlin {\n    sourceSets {\n        commonMain.dependencies {\n            implementation("io.github.hyochan:kmp-iap:1.2.2")\n        }\n    }\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"version-catalog-libsversionstoml",children:"Version Catalog (libs.versions.toml)"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-toml",children:'[versions]\nkmp-iap = "1.2.2"\n\n[libraries]\nkmp-iap = { module = "io.github.hyochan:kmp-iap", version.ref = "kmp-iap" }\n'})}),"\n",(0,l.jsx)(n.h3,{id:"cocoapods",children:"CocoaPods"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ruby",children:"pod 'kmp-iap', '~> 1.2.2'\n"})}),"\n",(0,l.jsx)(n.h2,{id:"documentation",children:"Documentation"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"/docs/guides/alternative-billing",children:"Alternative Billing Guide"})," - Updated with External Payments section"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"https://developer.android.com/google/play/billing/externalpaymentlinks",children:"External Payment Links (Google)"})," - Official documentation"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"/blog/release-1.2.1",children:"1.2.1 Release Notes"})," - Previous patch release"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"/blog/release-1.2.0",children:"1.2.0 Release Notes"})," - Full feature release notes"]}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"/docs/api/core-methods",children:"API Reference - Core Methods"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/hyochan/kmp-iap/releases/tag/1.2.2",children:"GitHub Release"})}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["Questions or feedback? Reach out via ",(0,l.jsx)(n.a,{href:"https://github.com/hyochan/kmp-iap/issues",children:"GitHub Issues"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(c,{...e})}):c(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>t});var l=i(6540);const a={},r=l.createContext(a);function s(e){const n=l.useContext(r);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),l.createElement(r.Provider,{value:n},e.children)}}}]);