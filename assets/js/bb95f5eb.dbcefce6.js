"use strict";(self.webpackChunkkmp_iap_docs=self.webpackChunkkmp_iap_docs||[]).push([[8203],{5948:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>t,default:()=>p,frontMatter:()=>r,metadata:()=>o,toc:()=>c});var s=i(4848),d=i(8453);const r={slug:"release-1.3.4",title:"1.3.4 - One-Time Purchase Discounts & Simplified Field Names",authors:["hyochan"],tags:["release","openiap","kmp","android"],description:"KMP-IAP 1.3.4 syncs with OpenIAP gql v1.3.15 - adding one-time purchase discount support for Android 7.0+ and simplified input field naming conventions.",date:new Date("2026-01-20T00:00:00.000Z")},t="KMP-IAP 1.3.4",o={permalink:"/kmp-iap/blog/release-1.3.4",editUrl:"https://github.com/hyochan/kmp-iap/tree/main/docs/blog/2026-01-20-release-1.3.4.md",source:"@site/blog/2026-01-20-release-1.3.4.md",title:"1.3.4 - One-Time Purchase Discounts & Simplified Field Names",description:"KMP-IAP 1.3.4 syncs with OpenIAP gql v1.3.15 - adding one-time purchase discount support for Android 7.0+ and simplified input field naming conventions.",date:"2026-01-20T00:00:00.000Z",formattedDate:"January 20, 2026",tags:[{label:"release",permalink:"/kmp-iap/blog/tags/release"},{label:"openiap",permalink:"/kmp-iap/blog/tags/openiap"},{label:"kmp",permalink:"/kmp-iap/blog/tags/kmp"},{label:"android",permalink:"/kmp-iap/blog/tags/android"}],readingTime:2.085,hasTruncateMarker:!0,authors:[{name:"Hyo",title:"Maintainer of kmp-iap",url:"https://github.com/hyochan",imageURL:"https://github.com/hyochan.png",key:"hyochan"}],frontMatter:{slug:"release-1.3.4",title:"1.3.4 - One-Time Purchase Discounts & Simplified Field Names",authors:["hyochan"],tags:["release","openiap","kmp","android"],description:"KMP-IAP 1.3.4 syncs with OpenIAP gql v1.3.15 - adding one-time purchase discount support for Android 7.0+ and simplified input field naming conventions.",date:"2026-01-20T00:00:00.000Z"},unlisted:!1,prevItem:{title:"1.3.6 - ExternalPurchaseCustomLink API Types (iOS 18.1+)",permalink:"/kmp-iap/blog/release-1.3.6"},nextItem:{title:"1.3.2 - Android Product Status Codes & Type Updates",permalink:"/kmp-iap/blog/release-1.3.2"}},l={authorsImageUrls:[void 0]},c=[{value:"New Features",id:"new-features",level:2},{value:"One-Time Purchase Discounts (Android 7.0+)",id:"one-time-purchase-discounts-android-70",level:3},{value:"Simplified Input Field Names",id:"simplified-input-field-names",level:2},{value:"Migration Guide",id:"migration-guide",level:3},{value:"Code Migration",id:"code-migration",level:3},{value:"DSL Updates",id:"dsl-updates",level:3},{value:"OpenIAP Versions",id:"openiap-versions",level:2},{value:"Installation",id:"installation",level:2},{value:"References",id:"references",level:2}];function a(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:["This release syncs with ",(0,s.jsx)(n.a,{href:"https://www.openiap.dev/docs/updates/notes#gql-1-3-15-google-1-3-26-apple-1-3-13",children:"OpenIAP gql v1.3.15 / google v1.3.26 / apple v1.3.13"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"new-features",children:"New Features"}),"\n",(0,s.jsx)(n.h3,{id:"one-time-purchase-discounts-android-70",children:"One-Time Purchase Discounts (Android 7.0+)"}),"\n",(0,s.jsxs)(n.p,{children:["Apply discount offers to one-time (non-subscription) purchases using the new ",(0,s.jsx)(n.code,{children:"offerToken"})," field:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-kotlin",children:'// Fetch products and get available discount offers\nval products = kmpIapInstance.fetchProducts {\n    skus = listOf("premium_unlock")\n    type = ProductQueryType.InApp\n}\n\nval product = products.firstOrNull { it.id == "premium_unlock" }\n\n// Check for available discount offers on one-time purchases\n(product as? ProductAndroid)?.let { androidProduct ->\n    val discountOffer = androidProduct.oneTimePurchaseOfferDetailsAndroid\n        ?.discountOffers\n        ?.firstOrNull()\n\n    if (discountOffer != null) {\n        // Purchase with discount applied\n        kmpIapInstance.requestPurchase {\n            type = ProductType.InApp\n            android {\n                skus = listOf("premium_unlock")\n                offerToken = discountOffer.offerToken  // Apply discount\n            }\n        }\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"simplified-input-field-names",children:"Simplified Input Field Names"}),"\n",(0,s.jsxs)(n.p,{children:["Input field names for Android-specific request props have been simplified by removing redundant ",(0,s.jsx)(n.code,{children:"Android"})," suffixes. This follows the OpenIAP naming convention where input types inside platform-specific props don't need platform suffixes (they're already scoped to Android)."]}),"\n",(0,s.jsx)(n.h3,{id:"migration-guide",children:"Migration Guide"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"RequestPurchaseAndroidProps:"})}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Old Name"}),(0,s.jsx)(n.th,{children:"New Name"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"obfuscatedAccountIdAndroid"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"obfuscatedAccountId"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"obfuscatedProfileIdAndroid"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"obfuscatedProfileId"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"-"}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:"offerToken"})," (NEW)"]})]})]})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"RequestSubscriptionAndroidProps:"})}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Old Name"}),(0,s.jsx)(n.th,{children:"New Name"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"obfuscatedAccountIdAndroid"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"obfuscatedAccountId"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"obfuscatedProfileIdAndroid"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"obfuscatedProfileId"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"purchaseTokenAndroid"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"purchaseToken"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"replacementModeAndroid"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"replacementMode"})})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"code-migration",children:"Code Migration"}),"\n",(0,s.jsx)(n.p,{children:"If you're using the raw props directly:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-kotlin",children:'// Before (1.3.2 and earlier)\nRequestPurchaseAndroidProps(\n    skus = listOf("sku"),\n    obfuscatedAccountIdAndroid = "account-123",\n    obfuscatedProfileIdAndroid = "profile-456"\n)\n\nRequestSubscriptionAndroidProps(\n    skus = listOf("sub"),\n    purchaseTokenAndroid = "token",\n    replacementModeAndroid = 1,\n    obfuscatedAccountIdAndroid = "account-123",\n    obfuscatedProfileIdAndroid = "profile-456"\n)\n\n// After (1.3.4+)\nRequestPurchaseAndroidProps(\n    skus = listOf("sku"),\n    obfuscatedAccountId = "account-123",\n    obfuscatedProfileId = "profile-456",\n    offerToken = "discount-token"  // NEW: for one-time purchase discounts\n)\n\nRequestSubscriptionAndroidProps(\n    skus = listOf("sub"),\n    purchaseToken = "token",\n    replacementMode = 1,\n    obfuscatedAccountId = "account-123",\n    obfuscatedProfileId = "profile-456"\n)\n'})}),"\n",(0,s.jsx)(n.h3,{id:"dsl-updates",children:"DSL Updates"}),"\n",(0,s.jsx)(n.p,{children:"The DSL builders have been updated with the new field names:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-kotlin",children:'// Before (1.3.2 and earlier)\nkmpIapInstance.requestPurchase {\n    android {\n        skus = listOf("sku")\n        obfuscatedAccountIdAndroid = "account-123"\n        obfuscatedProfileIdAndroid = "profile-456"\n    }\n}\n\n// After (1.3.4+)\nkmpIapInstance.requestPurchase {\n    android {\n        skus = listOf("sku")\n        obfuscatedAccountId = "account-123"\n        obfuscatedProfileId = "profile-456"\n        offerToken = "discount-token"\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"openiap-versions",children:"OpenIAP Versions"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Package"}),(0,s.jsx)(n.th,{children:"Version"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"openiap-gql"}),(0,s.jsx)(n.td,{children:"1.3.15"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"openiap-google"}),(0,s.jsx)(n.td,{children:"1.3.26"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"openiap-apple"}),(0,s.jsx)(n.td,{children:"1.3.13"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-kotlin",children:'implementation("io.github.hyochan:kmp-iap:1.3.4")\n'})}),"\n",(0,s.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.openiap.dev/docs/updates/notes#gql-1-3-15-google-1-3-26-apple-1-3-13",children:"OpenIAP gql v1.3.15 / google v1.3.26 / apple v1.3.13 Release Notes"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://developer.android.com/google/play/billing/migrate-billing-7",children:"Google Play Billing 7.0 One-Time Purchase Discounts"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/blog/release-1.3.2",children:"1.3.2 Release Notes"})," - Previous release"]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>o});var s=i(6540);const d={},r=s.createContext(d);function t(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:t(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);