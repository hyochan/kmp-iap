"use strict";(self.webpackChunkkmp_iap_docs=self.webpackChunkkmp_iap_docs||[]).push([[6308],{1437:(e,i,n)=>{n.d(i,{A:()=>s});n(6540);var r=n(7856),t=n(4848);function s({children:e,href:i,className:n,style:s}){return(0,t.jsx)("a",{href:i||r.V,target:"_blank",rel:"noopener noreferrer",onClick:async()=>{try{await fetch(r.I,{method:"POST",mode:"no-cors"})}catch(e){console.error("Failed to track link click:",e)}},className:n,style:s,children:e})}},3141:(e,i,n)=>{n.d(i,{A:()=>r});const r=n.p+"assets/images/iapkit-bd9338b727269d19277cf36c59af5384.png"},7653:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>d,contentTitle:()=>l,default:()=>p,frontMatter:()=>a,metadata:()=>c,toc:()=>o});var r=n(4848),t=n(8453),s=n(1437);const a={slug:"release-1.0.0",title:"1.0.0 - Built-in Purchase Verification (aka Receipt Validation)",authors:["hyochan"],tags:["release","iapkit","verification","backend","security","openiap"],description:"KMP-IAP 1.0.0 brings built-in purchase verification (aka receipt validation) powered by IAPKit. Verify purchases with enterprise-grade backend validation using a single API call-no server setup required.",image:"/img/iapkit.png",date:new Date("2025-12-09T00:00:00.000Z")},l="KMP-IAP 1.0.0",c={permalink:"/kmp-iap/blog/release-1.0.0",editUrl:"https://github.com/hyochan/kmp-iap/tree/main/docs/blog/2025-12-09-release-1.0.0.md",source:"@site/blog/2025-12-09-release-1.0.0.md",title:"1.0.0 - Built-in Purchase Verification (aka Receipt Validation)",description:"KMP-IAP 1.0.0 brings built-in purchase verification (aka receipt validation) powered by IAPKit. Verify purchases with enterprise-grade backend validation using a single API call-no server setup required.",date:"2025-12-09T00:00:00.000Z",formattedDate:"December 9, 2025",tags:[{label:"release",permalink:"/kmp-iap/blog/tags/release"},{label:"iapkit",permalink:"/kmp-iap/blog/tags/iapkit"},{label:"verification",permalink:"/kmp-iap/blog/tags/verification"},{label:"backend",permalink:"/kmp-iap/blog/tags/backend"},{label:"security",permalink:"/kmp-iap/blog/tags/security"},{label:"openiap",permalink:"/kmp-iap/blog/tags/openiap"}],readingTime:3.96,hasTruncateMarker:!0,authors:[{name:"Hyo",title:"Maintainer of kmp-iap",url:"https://github.com/hyochan",imageURL:"https://github.com/hyochan.png",key:"hyochan"}],frontMatter:{slug:"release-1.0.0",title:"1.0.0 - Built-in Purchase Verification (aka Receipt Validation)",authors:["hyochan"],tags:["release","iapkit","verification","backend","security","openiap"],description:"KMP-IAP 1.0.0 brings built-in purchase verification (aka receipt validation) powered by IAPKit. Verify purchases with enterprise-grade backend validation using a single API call-no server setup required.",image:"/img/iapkit.png",date:"2025-12-09T00:00:00.000Z"},unlisted:!1,prevItem:{title:"1.2.0 - Billing Programs API & One-Time Product Discounts",permalink:"/kmp-iap/blog/release-1.2.0"},nextItem:{title:"1.0.0-rc.4 - OpenIAP Monorepo Conversion & Alternative Billing",permalink:"/kmp-iap/blog/1.0.0-rc.4"}},d={authorsImageUrls:[void 0]},o=[{value:"Why IAPKit?",id:"why-iapkit",level:2},{value:"Key Benefits",id:"key-benefits",level:3},{value:"Getting Started",id:"getting-started",level:2},{value:"Highlights",id:"highlights",level:2},{value:"Type System Updates",id:"type-system-updates",level:2},{value:"New <code>IapStore</code> Enum",id:"new-iapstore-enum",level:3},{value:"Updated Purchase Types",id:"updated-purchase-types",level:3},{value:"Request Parameters",id:"request-parameters",level:3},{value:"Migration from 1.0.0-rc",id:"migration-from-100-rc",level:2},{value:"Store Field",id:"store-field",level:3},{value:"Verification Integration",id:"verification-integration",level:3},{value:"IAPKit Purchase States",id:"iapkit-purchase-states",level:2},{value:"Installation",id:"installation",level:2},{value:"Gradle (Kotlin DSL)",id:"gradle-kotlin-dsl",level:3},{value:"Gradle (Groovy)",id:"gradle-groovy",level:3},{value:"Version Catalog (libs.versions.toml)",id:"version-catalog-libsversionstoml",level:3},{value:"References",id:"references",level:2}];function h(e){const i={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.p,{children:(0,r.jsx)(i.img,{alt:"IAPKit Integration",src:n(3141).A+"",width:"1024",height:"1024"})}),"\n",(0,r.jsxs)(i.p,{children:["KMP-IAP 1.0.0 brings ",(0,r.jsx)(i.strong,{children:"built-in purchase verification"})," (aka receipt validation) powered by ",(0,r.jsx)(s.A,{children:"IAPKit"}),". Now you can verify purchases with enterprise-grade backend validation using a single API call-no server setup required."]}),"\n",(0,r.jsx)(i.h2,{id:"why-iapkit",children:"Why IAPKit?"}),"\n",(0,r.jsxs)(i.p,{children:["Purchase verification is critical for any production IAP implementation. Without proper server-side validation, your app is vulnerable to receipt tampering, replay attacks, and fraudulent transactions. ",(0,r.jsx)(s.A,{children:"IAPKit"})," solves this with a battle-tested backend infrastructure. Sign up at ",(0,r.jsx)(s.A,{children:"iapkit.com"})," to get your API key and start verifying purchases in minutes."]}),"\n",(0,r.jsx)(i.h3,{id:"key-benefits",children:"Key Benefits"}),"\n",(0,r.jsxs)(i.table,{children:[(0,r.jsx)(i.thead,{children:(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.th,{style:{textAlign:"center"}}),(0,r.jsx)(i.th,{style:{textAlign:"left"},children:"Benefit"}),(0,r.jsx)(i.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,r.jsxs)(i.tbody,{children:[(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{style:{textAlign:"center"},children:"\ud83d\udd12"}),(0,r.jsx)(i.td,{style:{textAlign:"left"},children:(0,r.jsx)(i.strong,{children:"Security First"})}),(0,r.jsx)(i.td,{style:{textAlign:"left"},children:"Server-side validation that prevents fraud, receipt tampering, and token reuse. Far more secure than client-only verification."})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{style:{textAlign:"center"},children:"\ud83d\udd17"}),(0,r.jsx)(i.td,{style:{textAlign:"left"},children:(0,r.jsx)(i.strong,{children:"Unified API"})}),(0,r.jsx)(i.td,{style:{textAlign:"left"},children:"Single endpoint for both Apple App Store and Google Play. No separate validation logic needed."})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{style:{textAlign:"center"},children:"\u26a1"}),(0,r.jsx)(i.td,{style:{textAlign:"left"},children:(0,r.jsx)(i.strong,{children:"Zero Infrastructure"})}),(0,r.jsx)(i.td,{style:{textAlign:"left"},children:"No server setup required. IAPKit handles Apple and Google API complexity for you."})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{style:{textAlign:"center"},children:"\ud83c\udfed"}),(0,r.jsx)(i.td,{style:{textAlign:"left"},children:(0,r.jsx)(i.strong,{children:"Production Ready"})}),(0,r.jsx)(i.td,{style:{textAlign:"left"},children:"Enterprise-grade reliability with comprehensive error handling and detailed responses."})]})]})]}),"\n",(0,r.jsx)(i.h2,{id:"getting-started",children:"Getting Started"}),"\n",(0,r.jsxs)(i.p,{children:["Use the new ",(0,r.jsx)(i.code,{children:"verifyPurchaseWithProvider"})," API to verify purchases through IAPKit:"]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-kotlin",children:'import io.github.hyochan.kmpiap.kmpIapInstance\nimport io.github.hyochan.kmpiap.openiap.*\n\nval result = kmpIapInstance.verifyPurchaseWithProvider(\n    VerifyPurchaseWithProviderProps(\n        provider = PurchaseVerificationProvider.Iapkit,\n        iapkit = RequestVerifyPurchaseWithIapkitProps(\n            apiKey = "your-iapkit-api-key",\n            apple = RequestVerifyPurchaseWithIapkitAppleProps(jws = purchase.jws),\n            google = RequestVerifyPurchaseWithIapkitGoogleProps(\n                purchaseToken = purchase.purchaseToken\n            )\n        )\n    )\n)\n\nif (result.iapkit?.isValid == true) {\n    // Purchase verified - grant entitlement\n    println("Purchase state: ${result.iapkit?.state}")\n    println("Store: ${result.iapkit?.store}")\n}\n'})}),"\n",(0,r.jsxs)(i.p,{children:["The API returns a unified ",(0,r.jsx)(i.code,{children:"VerifyPurchaseWithProviderResult"})," with:"]}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.code,{children:"isValid"})," - Whether the purchase passed verification"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.code,{children:"state"})," - Detailed purchase state (entitled, pending, expired, canceled, etc.)"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.code,{children:"store"})," - The store where the purchase was made (apple, google, horizon)"]}),"\n"]}),"\n",(0,r.jsx)(i.h2,{id:"highlights",children:"Highlights"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"IAPKit Integration"})," - Built-in purchase verification (aka receipt validation) with enterprise-grade backend"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:(0,r.jsx)(i.a,{href:"https://www.openiap.dev/docs/updates/announcements#2025-12-09",children:"OpenIAP 1.3.0"})})," - Updated to openiap-apple v1.3.0, openiap-google v1.3.10, and openiap-gql v1.3.0"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsxs)(i.strong,{children:["New ",(0,r.jsx)(i.code,{children:"IapStore"})," Type"]})," - Unified store identification: ",(0,r.jsx)(i.code,{children:"Unknown"}),", ",(0,r.jsx)(i.code,{children:"Apple"}),", ",(0,r.jsx)(i.code,{children:"Google"}),", ",(0,r.jsx)(i.code,{children:"Horizon"})]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Enhanced Purchase Types"})," - New ",(0,r.jsx)(i.code,{children:"store"})," field on Purchase (replaces deprecated ",(0,r.jsx)(i.code,{children:"platform"}),")"]}),"\n"]}),"\n",(0,r.jsx)(i.h2,{id:"type-system-updates",children:"Type System Updates"}),"\n",(0,r.jsx)(i.p,{children:"This release brings important type refinements aligned with the OpenIAP 1.3.0 specification:"}),"\n",(0,r.jsxs)(i.h3,{id:"new-iapstore-enum",children:["New ",(0,r.jsx)(i.code,{children:"IapStore"})," Enum"]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-kotlin",children:'enum class IapStore(val rawValue: String) {\n    Unknown("unknown"),\n    Apple("apple"),\n    Google("google"),\n    Horizon("horizon")\n}\n'})}),"\n",(0,r.jsx)(i.h3,{id:"updated-purchase-types",children:"Updated Purchase Types"}),"\n",(0,r.jsxs)(i.p,{children:["All purchase types now include a ",(0,r.jsx)(i.code,{children:"store"})," field for unified store identification:"]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-kotlin",children:'val purchase = PurchaseIOS(\n    productId = "premium",\n    transactionId = "12345",\n    store = IapStore.Apple, // NEW - unified store identification\n    // ...other fields\n)\n'})}),"\n",(0,r.jsx)(i.h3,{id:"request-parameters",children:"Request Parameters"}),"\n",(0,r.jsxs)(i.p,{children:["Request parameters now support ",(0,r.jsx)(i.code,{children:"apple"}),"/",(0,r.jsx)(i.code,{children:"google"})," keys alongside the legacy ",(0,r.jsx)(i.code,{children:"ios"}),"/",(0,r.jsx)(i.code,{children:"android"}),":"]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-kotlin",children:"// New (recommended)\nkmpIapInstance.requestPurchase(\n    RequestPurchaseProps(\n        apple = RequestPurchasePropsApple(sku = productId),\n        google = RequestPurchasePropsGoogle(skus = listOf(productId))\n    )\n)\n\n// Legacy (still supported but deprecated)\nkmpIapInstance.requestPurchase(\n    RequestPurchaseProps(\n        ios = RequestPurchasePropsIos(sku = productId),\n        android = RequestPurchasePropsAndroid(skus = listOf(productId))\n    )\n)\n"})}),"\n",(0,r.jsx)(i.h2,{id:"migration-from-100-rc",children:"Migration from 1.0.0-rc"}),"\n",(0,r.jsx)(i.h3,{id:"store-field",children:"Store Field"}),"\n",(0,r.jsxs)(i.p,{children:["If you're checking platform-specific purchases, consider using the new ",(0,r.jsx)(i.code,{children:"store"})," field:"]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-kotlin",children:"// Before (1.0.0-rc)\nif (purchase.platform == IapPlatform.Ios) {\n    // Handle iOS purchase\n}\n\n// After (1.0.0)\nif (purchase.store == IapStore.Apple) {\n    // Handle Apple purchase\n}\n"})}),"\n",(0,r.jsx)(i.h3,{id:"verification-integration",children:"Verification Integration"}),"\n",(0,r.jsx)(i.p,{children:"Add purchase verification to your existing purchase flow:"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-kotlin",children:'import io.github.hyochan.kmpiap.kmpIapInstance\nimport io.github.hyochan.kmpiap.openiap.*\nimport kotlinx.coroutines.flow.collect\nimport kotlinx.coroutines.launch\n\n// After successful purchase\nscope.launch {\n    kmpIapInstance.purchaseUpdatedListener.collect { purchase ->\n        // Verify the purchase\n        val verification = kmpIapInstance.verifyPurchaseWithProvider(\n            VerifyPurchaseWithProviderProps(\n                provider = PurchaseVerificationProvider.Iapkit,\n                iapkit = RequestVerifyPurchaseWithIapkitProps(\n                    apiKey = "your-api-key",\n                    apple = RequestVerifyPurchaseWithIapkitAppleProps(\n                        jws = (purchase as? PurchaseIOS)?.jwsRepresentationIOS\n                    ),\n                    google = RequestVerifyPurchaseWithIapkitGoogleProps(\n                        purchaseToken = purchase.purchaseToken\n                    )\n                )\n            )\n        )\n\n        if (verification.iapkit?.isValid == true) {\n            // Grant entitlement\n            grantPurchase(purchase.productId)\n\n            // Finish the transaction\n            kmpIapInstance.finishTransaction(\n                purchase = purchase,\n                isConsumable = true\n            )\n        }\n    }\n}\n'})}),"\n",(0,r.jsx)(i.h2,{id:"iapkit-purchase-states",children:"IAPKit Purchase States"}),"\n",(0,r.jsxs)(i.p,{children:["The ",(0,r.jsx)(i.code,{children:"IapkitPurchaseState"})," enum provides detailed purchase status:"]}),"\n",(0,r.jsxs)(i.table,{children:[(0,r.jsx)(i.thead,{children:(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.th,{children:"State"}),(0,r.jsx)(i.th,{children:"Description"})]})}),(0,r.jsxs)(i.tbody,{children:[(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"Entitled"})}),(0,r.jsx)(i.td,{children:"Purchase is valid and user has access"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"PendingAcknowledgment"})}),(0,r.jsx)(i.td,{children:"Purchase needs acknowledgment (Android)"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"Pending"})}),(0,r.jsx)(i.td,{children:"Purchase is being processed"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"Canceled"})}),(0,r.jsx)(i.td,{children:"Purchase was canceled"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"Expired"})}),(0,r.jsx)(i.td,{children:"Subscription has expired"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"ReadyToConsume"})}),(0,r.jsx)(i.td,{children:"Consumable ready to be consumed"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"Consumed"})}),(0,r.jsx)(i.td,{children:"Consumable has been consumed"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"Inauthentic"})}),(0,r.jsx)(i.td,{children:"Purchase failed verification (potential fraud)"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"Unknown"})}),(0,r.jsx)(i.td,{children:"Unknown state"})]})]})]}),"\n",(0,r.jsx)(i.h2,{id:"installation",children:"Installation"}),"\n",(0,r.jsx)(i.h3,{id:"gradle-kotlin-dsl",children:"Gradle (Kotlin DSL)"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-kotlin",children:'// shared/build.gradle.kts\nkotlin {\n    sourceSets {\n        commonMain.dependencies {\n            implementation("io.github.hyochan:kmp-iap:1.0.0")\n        }\n    }\n}\n'})}),"\n",(0,r.jsx)(i.h3,{id:"gradle-groovy",children:"Gradle (Groovy)"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-groovy",children:"// shared/build.gradle\nkotlin {\n    sourceSets {\n        commonMain {\n            dependencies {\n                implementation 'io.github.hyochan:kmp-iap:1.0.0'\n            }\n        }\n    }\n}\n"})}),"\n",(0,r.jsx)(i.h3,{id:"version-catalog-libsversionstoml",children:"Version Catalog (libs.versions.toml)"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-toml",children:'[versions]\nkmp-iap = "1.0.0"\n\n[libraries]\nkmp-iap = { module = "io.github.hyochan:kmp-iap", version.ref = "kmp-iap" }\n'})}),"\n",(0,r.jsx)(i.p,{children:"Then sync your Gradle project."}),"\n",(0,r.jsx)(i.h2,{id:"references",children:"References"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsx)(s.A,{children:"IAPKit"}),"\n"]}),"\n",(0,r.jsx)(i.li,{children:(0,r.jsx)(i.a,{href:"https://hyochan.github.io/kmp-iap/docs/api/core-methods#verifypurchasewithprovider",children:"verifyPurchaseWithProvider API"})}),"\n",(0,r.jsx)(i.li,{children:(0,r.jsx)(i.a,{href:"https://openiap.dev",children:"OpenIAP Ecosystem"})}),"\n",(0,r.jsx)(i.li,{children:(0,r.jsx)(i.a,{href:"/docs/examples/purchase-flow",children:"Purchase Flow Example"})}),"\n",(0,r.jsx)(i.li,{children:(0,r.jsx)(i.a,{href:"/docs/examples/subscription-flow",children:"Subscription Flow Example"})}),"\n"]}),"\n",(0,r.jsxs)(i.p,{children:["Questions or feedback? Reach out via ",(0,r.jsx)(i.a,{href:"https://github.com/hyochan/kmp-iap/issues",children:"GitHub Issues"})," or join our ",(0,r.jsx)(i.a,{href:"https://hyo.dev/joinSlack",children:"Slack community"}),"."]})]})}function p(e={}){const{wrapper:i}={...(0,t.R)(),...e.components};return i?(0,r.jsx)(i,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},7856:(e,i,n)=>{n.d(i,{I:()=>t,V:()=>r});const r="https://iapkit.com",t="https://www.hyo.dev/api/ad-banner/cmjf0l20n0002249hjrwmgob3"},8453:(e,i,n)=>{n.d(i,{R:()=>a,x:()=>l});var r=n(6540);const t={},s=r.createContext(t);function a(e){const i=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function l(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),r.createElement(s.Provider,{value:i},e.children)}}}]);