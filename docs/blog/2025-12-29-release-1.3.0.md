---
slug: release-1.3.0
title: 1.3.0 - PurchaseState Cleanup & API Consolidation
authors: [hyochan]
tags: [release, minor, breaking-change]
description: KMP-IAP 1.3.0 reflects OpenIAP updates - PurchaseState simplified and BillingProgramAndroid consolidated.
date: 2025-12-29
---

# KMP-IAP 1.3.0

This release reflects the [OpenIAP gql v1.3.11 / google v1.3.21 / apple v1.3.9](https://www.openiap.dev/docs/updates/notes#gql-1-3-11-google-1-3-21-apple-1-3-9) updates.

<!-- truncate -->

## Breaking Changes

### PurchaseState Simplified

```kotlin
// Before (v1.2.x)
enum class PurchaseState {
    Pending, Purchased, Failed, Restored, Deferred, Unknown
}

// After (v1.3.0)
enum class PurchaseState {
    Pending, Purchased, Unknown
}
```

**Migration:**
```kotlin
// Before
when (purchase.purchaseState) {
    PurchaseState.Purchased, PurchaseState.Restored -> handleSuccess()
    PurchaseState.Pending, PurchaseState.Deferred -> handlePending()
    PurchaseState.Failed -> handleFailure()
    else -> {}
}

// After
when (purchase.purchaseState) {
    PurchaseState.Purchased -> handleSuccess()
    PurchaseState.Pending -> handlePending()
    PurchaseState.Unknown -> {}
}
// Handle failures via purchaseErrorListener
```

### API Consolidation: BillingProgramAndroid

`AlternativeBillingModeAndroid` deprecated. Use `BillingProgramAndroid` with `enableBillingProgramAndroid`.

```kotlin
// Before (deprecated)
val config = InitConnectionConfig(
    alternativeBillingModeAndroid = AlternativeBillingModeAndroid.UserChoice
)

// After (recommended)
val config = InitConnectionConfig(
    enableBillingProgramAndroid = BillingProgramAndroid.UserChoiceBilling
)
```

| Before (Deprecated) | After (Recommended) |
|---------------------|---------------------|
| `alternativeBillingModeAndroid: USER_CHOICE` | `enableBillingProgramAndroid: USER_CHOICE_BILLING` |
| `alternativeBillingModeAndroid: ALTERNATIVE_ONLY` | `enableBillingProgramAndroid: EXTERNAL_OFFER` |

### RequestPurchaseProps.useAlternativeBilling Deprecated

`useAlternativeBilling` field is deprecated - it only logged debug info and had no effect on the purchase flow.

## Installation

```kotlin
implementation("io.github.hyochan:kmp-iap:1.3.0")
```

## References

- [OpenIAP Update Notes](https://www.openiap.dev/docs/updates/notes#gql-1-3-11-google-1-3-21-apple-1-3-9)
- [1.2.2 Release Notes](/blog/release-1.2.2) - Previous release
- [API Reference - Types](/docs/api/types)
